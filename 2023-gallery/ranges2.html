
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width,initial-scale=1" name="viewport">
    <!-- .htmlseed 24.1.25 made with love ~ ʕ⊙ᴥ⊙ʔ ~ -->

    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> Tab data -->
    <title>ranges II</title>
    <meta name="theme-color" content="#314159">
    <link rel="icon" type="image/png" href="app/icon512.png">
    <meta name="description"  content="htmlseed">
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ -->

    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> CSS preset 2024 -->
    <style>
        body {
          --color--PaperTone: hsl( 37, 55%, 85%);
          --color--PaperDark: hsl(  0,  0%,  8%);
          --color--PaperRose: hsl(359, 59%, 43%);

          --background-color: var(--color--PaperTone);
          --foreground-color: var(--color--PaperDark);
              --accent-color: var(--color--PaperRose);
        }

        body {
            background-color: var(--background-color);
            margin: 0; color: var(--foreground-color);
            font-family: monospace; overflow-y:scroll;
        }

        a {
            color: inherit;
            text-decoration: underline;
        }

        img, video, svg {
            margin: 0;
            border: 0;
            max-width: 100%;
            display:  block;
        }

        center {
            display: grid;
            place-items: center;
        }
    </style>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> CSS custom -->
    <style>
        [display-source] {
            display: block;
            padding: 0 1em 1em 0;
            margin:  0 0   1em 0;
            max-width: max-content;
            font-family: monospace;
            white-space: pre;
            overflow-x: auto;
        }
        [contenteditable] {
          --color: var(--accent-color);
            color: var(--color);
            border-left: 1em solid var(--color);
        }
    </style>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> CSS stylesheet -->
    <link
        href="app/custom.css"
        type="text/css" rel="stylesheet" media="all">
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ -->

</head>
<body class="">
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> SECTION -->
    <style display-source contenteditable>
        body {
          --background-color: white;
          --foreground-color: var(--color--PaperDark);
              --accent-color: var(--color--PaperRose);
        }
    </style>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> DEMO 2 -->
    <div style="height:120vh;"></div>
    <article class="layoutValley defaultDemo" id="ObservableRangearea">
        <section sky-header>header</section>
        <section sky-layers><p/><p/><p/><p/></section>
        <section sea-layers><p/><p/><p/><p/></section>
        <section sea-footer>footer</section>
    </article>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> CSS -->
    <style display-source contenteditable>
    /** ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ layoutValley */
    /** 24.1.27 **/

        .layoutValley,
        .layoutValley.defaultSettings {
          --width--total:  100vw;
          --height--total:  86vh;
            background: lightskyblue;
        }

        /* layout */

        .layoutValley {
            height:    var(--height--total);
            width:     var(--width--total);
            max-width: 100%;
            overflow:  hidden;
            position:  relative;
        }
        .layoutValley [sky-header],
        .layoutValley [sky-layers]>*,
        .layoutValley [sea-layers]>*,
        .layoutValley [sea-footer] {
            position: absolute;
            left:  0;
            right: 0;
        }
        .layoutValley [sky-header]   {top:0; z-index:1}
        .layoutValley [sky-layers]>* {top:0}
        .layoutValley [sea-layers]>* {bottom:0}
        .layoutValley [sea-footer]   {bottom:0}

        /* layer picture box */

        .layoutValley [sky-header],
        .layoutValley [sky-layers]>*,
        .layoutValley [sea-layers]>*,
        .layoutValley [sea-footer] {
            height:           var(--rangeHeight, 0);
            background-image: var(--rangeImage);
            background-size:  var(--width--total) var(--rangeHeight);
            background-color: transparent;
            display:     grid;
            place-items: center;
            margin:      0;
            padding:     0;
        }

        /* layer extended background */

        .layoutValley [sky-layers]>*:after,
        .layoutValley [sea-layers]>*:after {
            content:  '';
            height:   var(--height--total);
            position: absolute;
            left:  0;
            right: 0;
            top: 100%;
            top: calc(100% - 1px);
            background-color: var(--rangeColor, transparent);
        }

        /* layer scroll offset */

        .layoutValley [sky-header]   {--rangeDirection: -1; transform:scale(var(--rangeDirection));}
        .layoutValley [sky-layers]>* {--rangeDirection: -1;}
        .layoutValley [sea-layers]>* {--rangeDirection:  1;}

        .layoutValley [sky-layers]>* ,
        .layoutValley [sea-layers]>* {
          --L: calc(var(--rangeOffsetRun,0) - (var(--rangeOffsetRun,0) - var(--rangeOffsetEnd,0)) * var(--rangeScroll));
          --Y: calc(-1 * var(--rangeDirection, 1) * var(--L, 0));
            transform: translateY(var(--Y)) scale(var(--rangeDirection));
        }
        .layoutValley [sky-layers]>* {--rangeOffsetRun: var(--rangeOffsetMin);}
        .layoutValley [sky-layers]>* {--rangeOffsetEnd: var(--rangeOffsetMax);}
        .layoutValley [sea-layers]>* {--rangeOffsetRun: var(--rangeOffsetMax);}
        .layoutValley [sea-layers]>* {--rangeOffsetEnd: var(--rangeOffsetMin);}

    /** ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ defaultDemo */

        .layoutValley.defaultDemo [sky-header]   {--rangeHeight:12vw}
        .layoutValley.defaultDemo [sky-layers]>* {--rangeHeight:10vw}
        .layoutValley.defaultDemo [sea-layers]>* {--rangeHeight:10vw}
        .layoutValley.defaultDemo [sea-footer]   {--rangeHeight:12vw}

        .layoutValley.defaultDemo [sky-layers]>:nth-child(1) {--rangeOffsetMax: 32vw}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(2) {--rangeOffsetMax: 26vw}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(3) {--rangeOffsetMax: 18vw}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(4) {--rangeOffsetMax: 12vw}

        .layoutValley.defaultDemo [sky-layers]>:nth-child(1) {--rangeOffsetMin: 10vw}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(2) {--rangeOffsetMin:  8vw}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(3) {--rangeOffsetMin:  6vw}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(4) {--rangeOffsetMin:  4vw}

        .layoutValley.defaultDemo [sea-layers]>:nth-child(1) {--rangeOffsetMax: 32vw}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(2) {--rangeOffsetMax: 26vw}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(3) {--rangeOffsetMax: 18vw}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(4) {--rangeOffsetMax: 12vw}

        .layoutValley.defaultDemo [sea-layers]>:nth-child(1) {--rangeOffsetMin: 10vw}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(2) {--rangeOffsetMin:  8vw}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(3) {--rangeOffsetMin:  6vw}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(4) {--rangeOffsetMin:  4vw}

        .layoutValley.defaultDemo [sky-header] {--rangeImage: url(art/moutRangeFin1.svg);}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(1) {--rangeImage: url(art/moutRange1.svg);}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(2) {--rangeImage: url(art/moutRange2.svg);}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(3) {--rangeImage: url(art/moutRange3.svg);}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(4) {--rangeImage: url(art/moutRange4.svg);}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(1) {--rangeImage: url(art/moutRange1.svg);}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(2) {--rangeImage: url(art/moutRange2.svg);}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(3) {--rangeImage: url(art/moutRange3.svg);}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(4) {--rangeImage: url(art/moutRange4.svg);}
        .layoutValley.defaultDemo [sea-footer] {--rangeImage: url(art/moutRangeFin1.svg);}

        .layoutValley.defaultDemo [sky-layers]>:nth-child(1) {--rangeColor: hsl(212, 25%, 45%);}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(2) {--rangeColor: hsl(212, 30%, 40%);}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(3) {--rangeColor: hsl(212, 35%, 35%);}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(4) {--rangeColor: hsl(212, 40%, 30%);}

        .layoutValley.defaultDemo [sea-layers]>:nth-child(1) {--rangeColor: hsl(212, 25%, 45%);}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(2) {--rangeColor: hsl(212, 30%, 40%);}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(3) {--rangeColor: hsl(212, 35%, 35%);}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(4) {--rangeColor: hsl(212, 40%, 30%);}

        @media all and (max-width:1080px) {
            .layoutValley [sky-header],
            .layoutValley [sky-layers]>*,
            .layoutValley [sea-layers]>*,
            .layoutValley [sea-footer] {
                background-size:  200vw var(--rangeHeight);
                background-position: 50% 0;
            }

        .layoutValley.defaultDemo [sky-header]   {--rangeHeight:12vh}
        .layoutValley.defaultDemo [sky-layers]>* {--rangeHeight:10vh}
        .layoutValley.defaultDemo [sea-layers]>* {--rangeHeight:10vh}
        .layoutValley.defaultDemo [sea-footer]   {--rangeHeight:12vh}

        .layoutValley.defaultDemo [sky-layers]>:nth-child(1) {--rangeOffsetMax: 32vh}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(2) {--rangeOffsetMax: 26vh}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(3) {--rangeOffsetMax: 18vh}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(4) {--rangeOffsetMax: 12vh}

        .layoutValley.defaultDemo [sky-layers]>:nth-child(1) {--rangeOffsetMin: 10vh}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(2) {--rangeOffsetMin:  8vh}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(3) {--rangeOffsetMin:  6vh}
        .layoutValley.defaultDemo [sky-layers]>:nth-child(4) {--rangeOffsetMin:  4vh}

        .layoutValley.defaultDemo [sea-layers]>:nth-child(1) {--rangeOffsetMax: 32vh}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(2) {--rangeOffsetMax: 26vh}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(3) {--rangeOffsetMax: 18vh}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(4) {--rangeOffsetMax: 12vh}

        .layoutValley.defaultDemo [sea-layers]>:nth-child(1) {--rangeOffsetMin: 10vh}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(2) {--rangeOffsetMin:  8vh}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(3) {--rangeOffsetMin:  6vh}
        .layoutValley.defaultDemo [sea-layers]>:nth-child(4) {--rangeOffsetMin:  4vh}
        }

    /** ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ /layoutValley */
    </style>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> JS -->
    <script>
    //~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ EventDebouncer 2024
        function EventDebouncer (callback) {
            this.callback = callback;
            this.ticking = false;
        };
        EventDebouncer.prototype = {
            constructor: EventDebouncer,
            update:
                function() {
                    this.callback && this.callback();
                    this.ticking = false;
                },
            requestTick:
                function() {
                    if(!this.ticking) {
                        const action = this.action || (this.action = this.update.bind(this));
                        requestAnimationFrame(action);
                        this.ticking = true;
                    }
                },
            handleEvent:
                function() {
                    this.requestTick();
                },
        };
    //~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ /EventDebouncer
    </script>
    <script>
    //~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #ObservableRangearea

        function runObservableRangearea () {
            const DOM = {
                area: document.getElementById('ObservableRangearea'),
                windowHeight: window.innerHeight,
            };
            const state = {
                active: false,
                boundingClientRect: {},
                intersectionRect: {},
                rootBounds: {},
            };
            const setRatioVar = () => {
                const wt = window.pageYOffset;
                const wh = DOM.windowHeight; //window.innerHeight;
                const vt = DOM.area.offsetTop;
                const vh = DOM.area.offsetHeight;
                const wayStart = vt - wh > 0 ? vt - wh : 0;
                const wayEnd = vt + vh;
                const wayDistance = wh + vh || 1;
                const wayDP = (wt - wayStart) / wayDistance;
                const rangeScroll = wayDP > 0 ? wayDP : wayDP < 1 ? 0:1;
                DOM.area.style.setProperty('--rangeScroll', `${rangeScroll}`);
            }
            const eventOnScroll = new EventDebouncer(setRatioVar);
            const eventOnScrollActivate = () => {
                if(!state.active) {
                    state.active = true;
                    window.addEventListener('scroll', eventOnScroll);
                }
            }
            const eventOnScrollDeactivate = () => {
                if (state.active) {
                    state.active = false;
                    window.removeEventListener('scroll', eventOnScroll);
                }
            }

            const obAction = entries => entries.forEach(entry => {
                const {isIntersecting} = entry;
                if ( isIntersecting ) eventOnScrollActivate();
                if (!isIntersecting ) eventOnScrollDeactivate();
            });
            const obOption = {
                rootMargin: '0% 0% 0% 0%',
                threshold:  [0],
            };
            const ObserverN1 = new IntersectionObserver(obAction,obOption);

            eventOnScroll.handleEvent();
            ObserverN1.observe(DOM.area);
        }
        runObservableRangearea();
    </script>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> DEMO 1 -->
    <article class="layoutParallaxValley defaultDemo">
        <header section>header</header>
        <section sky-header></section>
        <section sky-layers><p/><p/><p/><p/></section>
        <section sea-layers><p/><p/><p/><p/></section>
        <section sea-footer></section>
        <section class="xgroup x1"><p/><p/><p/><p/></section>
        <section class="xgroup x2"><p/><p/><p/><p/></section>
        <footer section>footer</footer>
    </article>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> CSS -->
    <style display-source contenteditable>
    /** ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ layoutParallaxValley */
    /** 24.1.27 **/

        .layoutParallaxValley,
        .layoutParallaxValley.defaultSettings {
          --width--total:  100vw;
          --height--total:  80vh;
            background: lightskyblue;
        }

        .layoutParallaxValley.defaultDemo >header  {--rangeHeight: 12vw}
        .layoutParallaxValley.defaultDemo >footer  {--rangeHeight: 12vw}
        .layoutParallaxValley.defaultDemo .xgroup>*{--rangeHeight: 10vw}

        .layoutParallaxValley.defaultDemo .xgroup>*{--rangeOffset: var(--o);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(1) {--o: calc(0.75 * var(--rangeHeight) * 3);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(2) {--o: calc(0.75 * var(--rangeHeight) * 1);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(3) {--o: calc(-0.75 * var(--rangeHeight) * 1);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(4) {--o: calc(-0.75 * var(--rangeHeight) * 3);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(1) {--o: calc(-0.75 * var(--rangeHeight) * 1);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(2) {--o: calc(-0.75 * var(--rangeHeight) * 2);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(3) {--o: calc(-0.75 * var(--rangeHeight) * 3);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(4) {--o: calc(-0.75 * var(--rangeHeight) * 4);}

        .layoutParallaxValley.defaultDemo >header  {--rangeImage: url(art/moutRangeFin1.svg);}
        .layoutParallaxValley.defaultDemo .xgroup>*{--rangeImage: var(--i);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(1) {--i: url(art/moutRange1.svg);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(2) {--i: url(art/moutRange2.svg);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(3) {--i: url(art/moutRange3.svg);}
        .layoutParallaxValley.defaultDemo .x1>:nth-child(4) {--i: url(art/moutRange4.svg);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(1) {--i: url(art/moutRange1.svg);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(2) {--i: url(art/moutRange2.svg);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(3) {--i: url(art/moutRange3.svg);}
        .layoutParallaxValley.defaultDemo .x2>:nth-child(4) {--i: url(art/moutRange4.svg);}
        .layoutParallaxValley.defaultDemo >footer  {--rangeImage: url(art/moutRangeFin1.svg);}

        .layoutParallaxValley {
            height:    var(--height--total);
            width:     var(--width--total);
            max-width: 100%;
            overflow:  hidden;
            position:  relative;
        }
        .layoutParallaxValley>header {
            left:0; right:0; top:0;
            /*RenderFix2024*/top:-1px;
            position: absolute;
        }
        .layoutParallaxValley>footer {
            left:0; right:0; bottom:0;
            /*RenderFix2024*/bottom:-1px;
            position: absolute;
        }

        .layoutParallaxValley >header,
        .layoutParallaxValley >footer {
            z-index: 1;
        }
        .layoutParallaxValley >header,
        .layoutParallaxValley >footer,
        .layoutParallaxValley .xgroup>* {
            height:           var(--rangeHeight, 0);
            background-image: var(--rangeImage);
            background-size:  var(--width--total) var(--rangeHeight);
            background-color: transparent;
            display:     grid;
            place-items: center;
            margin:      0;
            padding:     0;
            transform: scale(var(--transform-scale, 1));
        }

        .layoutParallaxValley .xgroup>* {
            display:  block;
            position: relative;
            transform: translateY(var(--rangeOffset)) scale(var(--transform-scale, 1));
        }
        .layoutParallaxValley .xgroup.x1 >*:after {
            content: '';
            left:0; right:0; top:100%;
            /*RenderFix2024*/top:calc(100% - 1px);
            position: absolute;
            height:   var(--height--total);
            background-color: red;
            opacity: 0.5;
        }
        .layoutParallaxValley .xgroup.x2 >*:after {
            content: '';
            left:0; right:0; top:100%;
            /*RenderFix2024*/top:calc(100% - 1px);
            position: absolute;
            height:   var(--height--total);
            background-color: red;
            opacity: 0.5;
        }

        .layoutParallaxValley.defaultDemo .xgroup.x1 >*,
        .layoutParallaxValley>header {--transform-scale: -1;}

    /** ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ /ParallaxValley */
    </style>
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> BLOB -->
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ -->
    <!-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~>> END -->
</body>
</html>
